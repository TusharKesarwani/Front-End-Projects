$(document).ready(function () {
  function format(d) {
    return (
      '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;"><tr><td>Full name:</td><td>' +
      d.name +
      "</td></tr><tr><td>Extension number:</td><td>" +
      d.extn +
      "</td></tr><tr><td>Extra info:</td><td>And any further details here (images etc)...</td></tr></table>"
    );
  }
  function filterGlobal() {
    $(".search-api")
      .DataTable()
      .search(
        $("#global_filter").val(),
        $("#global_regex").prop("checked"),
        $("#global_smart").prop("checked")
      )
      .draw();
  }
  function filterColumn(i) {
    $(".search-api")
      .DataTable()
      .column(i)
      .search(
        $("#col" + i + "_filter").val(),
        $("#col" + i + "_regex").prop("checked"),
        $("#col" + i + "_smart").prop("checked")
      )
      .draw();
  }
  var t = $(".add-rows").DataTable(),
    counter = 1;
  $("#addRow").on("click", function () {
    t.row
      .add([
        counter + ".1",
        counter + ".2",
        counter + ".3",
        counter + ".4",
        counter + ".5",
      ])
      .draw(!1),
      counter++;
  }),
    $("#addRow").trigger("click"),
    $(".text-inputs-searching tfoot th").each(function () {
      var title = $(this).text();
      $(this).html('<input type="text" placeholder="Search ' + title + '" />');
    });
  var tableSearching = $(".text-inputs-searching").DataTable();
  tableSearching.columns().every(function () {
    var that = this;
    $("input", this.footer()).on("keyup change", function () {
      that.search() !== this.value && that.search(this.value).draw();
    });
  }),
    $(".datatable-select-inputs").DataTable({
      initComplete: function () {
        this.api()
          .columns()
          .every(function () {
            var column = this,
              select = $(
                '<select><option value="">Select option</option></select>'
              )
                .appendTo($(column.footer()).empty())
                .on("change", function () {
                  var val = $.fn.dataTable.util.escapeRegex($(this).val());
                  column.search(val ? "^" + val + "$" : "", !0, !1).draw();
                });
            column
              .data()
              .unique()
              .sort()
              .each(function (d, j) {
                select.append('<option value="' + d + '">' + d + "</option>");
              });
          });
      },
    });
  var tableChildRows = $(".show-child-rows").DataTable({
    ajax: "../../../app-assets/data/datatables/ajax-child-rows.json",
    columns: [
      {
        className: "details-control",
        orderable: !1,
        data: null,
        defaultContent: "",
      },
      { data: "name" },
      { data: "position" },
      { data: "office" },
      { data: "salary" },
    ],
    order: [[1, "asc"]],
  });
  $(".show-child-rows tbody").on("click", "td.details-control", function () {
    var tr = $(this).closest("tr"),
      row = tableChildRows.row(tr);
    row.child.isShown()
      ? (row.child.hide(), tr.removeClass("shown"))
      : (row.child(format(row.data())).show(), tr.addClass("shown"));
  });
  var multipleRowsTable = $(".selection-multiple-rows").DataTable();
  $(".selection-multiple-rows tbody").on("click", "tr", function () {
    $(this).toggleClass("selected");
  }),
    $("#row-count").on("click", function () {
      alert(
        multipleRowsTable.rows(".selected").data().length + " row(s) selected"
      );
    });
  var tableselectionDelete = $(".selection-deletion-row").DataTable();
  $(".selection-deletion-row tbody").on("click", "tr", function () {
    $(this).hasClass("selected")
      ? $(this).removeClass("selected")
      : (tableselectionDelete.$("tr.selected").removeClass("selected"),
        $(this).addClass("selected"));
  }),
    $("#delete-row").on("click", function () {
      tableselectionDelete.row(".selected").remove().draw(!1);
    });
  var tableFormInputs = $(".submit-form-inputs").DataTable();
  $(".inputs-submin").on("click", function () {
    var data = tableFormInputs.$("input, select").serialize();
    return (
      alert(
        "The following data would have been submitted to the server: \n\n" +
          data.substr(0, 120) +
          "..."
      ),
      !1
    );
  });
  var tableDynamically = $(".hide-columns-dynamically").DataTable({
    scrollY: "200px",
    paging: !1,
  });
  $("a.toggle-vis").on("click", function (e) {
    e.preventDefault();
    var column = tableDynamically.column($(this).attr("data-column"));
    column.visible(!column.visible());
  }),
    $(".search-api").DataTable(),
    $("input.global_filter_search").on("keyup click", function () {
      filterGlobal();
    }),
    $("input.column_filter_search").on("keyup click", function () {
      filterColumn($(this).parents("tr").attr("data-column"));
    });
});
